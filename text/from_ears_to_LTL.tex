\section{Formalizing EARS using Linear Temporal Logic}

In this section we will use as running example the simplified requirements for
a controller for the engines of a (unspecified) machine. The machine includes a
\emph{main}, an \emph{auxiliary} and an \emph{oil pump} engine. The sequence to
start the machine is to first run the old pump engine; after 10 seconds start
the main engine; and finally after 5 more seconds start the auxiliary engine.
The \ears requirements for such a controller are depicted in
\fig\ref{fig:reqs_motor}.

\begin{figure}[!h]
\centering
\includegraphics[width=.5\textwidth]{figures/motor_ears}
\caption{\ears requirements expressed in the \earsctrl tool}
\label{fig:reqs_motor}
\end{figure}

\begin{figure*}
\begin{tabular}{ |c|c|c| } 
 \hline
Ubiquitous & \textbf{The} $\langle$\emph{system}$\rangle$ \textbf{shall}
$\langle$\emph{response}$\rangle$ & $\mathbf{G}(response)$
\\
  \hline
Event-Driven & \textbf{When} $\langle$\emph{trigger}$\rangle$ \textbf{the}
$\langle$\emph{system}$\rangle$ \textbf{shall} $\langle$\emph{response}$\rangle$
& $\mathbf{G}(trigger\rightarrow \textbf{X}(response))$
\\
 \hline 
State-Driven &  \textbf{While} $\langle$\emph{in state}$\rangle$ \textbf{the}
$\langle$\emph{system}$\rangle$ \textbf{shall} $\langle$\emph{response}$\rangle$
& $\mathbf{G}(\text{\emph{in state}}\rightarrow response)$ \\
 \hline

Option &  \textbf{Where} $\langle$\emph{feature}$\rangle$ \textbf{the}
$\langle$\emph{system}$\rangle$ \textbf{shall} $\langle$\emph{response}$\rangle$
& $\mathbf{G}(\text{\emph{feature}}\rightarrow response)$ \\
 \hline
 
Complex &  \textbf{While} $\langle$\emph{in state}$\rangle$, \textbf{when}
$\langle$\emph{trigger}$\rangle$, \textbf{the} $\langle$\emph{system}$\rangle$
\textbf{shall} $\langle$\emph{response}$\rangle$ & $\mathbf{G}((\text{\emph{in
state}} \land \text{\emph{trigger}})\rightarrow \textbf{X}(response))$ \\
 \hline
 
Unwanted &  \textbf{If} $\langle$\emph{preconditions}$\rangle$
$\langle$\emph{trigger}$\rangle$, \textbf{the} $\langle$\emph{system}$\rangle$
\textbf{shall} $\langle$\emph{response}$\rangle$ &
$\mathbf{G}((\text{\emph{preconditions}} \land \text{\emph{trigger}})\rightarrow
\textbf{X}(response))$ \\
 \hline
 
\end{tabular}
\caption{Translation between \ears templates and \ltl}
\label{fig:translation_ears_ltl}
\end{figure*}

Let us now build a set of \ltl formulas that reflect the semantics of these
requirements. \ltl builds on propositional logic by adding temporal operators to
it. Formulas in \ltl are particularly appropriate to express properties of
runs of a reactive system, meaning how the state of that system should evolve
over time. For example, one may want to state that always when a motor is on,
then a thermostat is measuring its temperature. Or that, while the start button
is pressed then the starter engine will attempt to run the main engine. Or
even, that eventually the motor will stop. \ltl incorporates operators to
describe these situations. Due to space limitations we will refrain from 
formally introduce \ltl here, but will rather explain the parts of it that are
relevant to our presentation. \ltl was first introduced by Pnueli in
1977~\cite{Pnueli77} and introductions to it abound in the literature and
internet.

By looking carefully at the example in \fig\ref{fig:reqs_motor} it is possible
to understand that all requirements are given in the form of \ears
\emph{event-driven} templates. Take for instance Req1. The translation of Req1
into \ltl would be as follows:

\begin{multline*}
\mathbf{G}(\text{\emph{start button pressed}} \rightarrow\\
\textbf{X}(\text{\emph{start oil motor}}\land \text{\emph{start 10 sec timer}}))
\end{multline*}

The mathematical expression above reads as: \emph{globally}
during a run of the system (temporal operator $\mathbf{G}$), if the system
receives the \emph{start button} event, then in the \emph{next} moment
(temporal operator $\mathbf{X}$) the motor will be started as well a 10 second timer.

In the table in \fig\ref{fig:translation_ears_ltl} we present a generic set of
rules for transforming the \ears templates presented in~\cite{EARS09} into \ltl. Note that
the transformation rules are relatively regular and are designed such that for
every state in a run of the system some output is triggered if a state satisfies
a given condition. In the \emph{ubiquitous} case, all states in the run have to
produce the response, which is enforced by the $\mathbf{G}$ operator. In the
\emph{state-driven} and \emph{option} case, the response is produced only if the
state meets a certain condition or a certain feature of the system is enabled.
Finally, the \emph{event-driven}, \emph{complex} and \emph{unwanted} patterns
are different in the sense that the response is only appears in the moment following
the arrival of the trigger (as imposed by the $\mathbf{X}$ operator).
